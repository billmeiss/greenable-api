=IF(OR(
    REGEXMATCH(AE10, "Cement"),
    REGEXMATCH(AE10, "Clinker"),
    REGEXMATCH(AE10, "Concrete")
  ), 
  IF(AND(NOT(ISBLANK(J10)), NOT(ISBLANK(N10))), "YES - Cement", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
    REGEXMATCH(AE10, "Paddy rice"),
    REGEXMATCH(AE10, "Wheat"),
    REGEXMATCH(AE10, "Cereal grains"),
    REGEXMATCH(AE10, "Vegetables, fruit, nuts"),
    REGEXMATCH(AE10, "Oil seeds"),
    REGEXMATCH(AE10, "Sugar cane, sugar beet"),
    REGEXMATCH(AE10, "Plant-based fibers"),
    REGEXMATCH(AE10, "Crops"),
    REGEXMATCH(AE10, "Cattle"),
    REGEXMATCH(AE10, "Pigs"),
    REGEXMATCH(AE10, "Poultry"),
    REGEXMATCH(AE10, "Meat animals"),
    REGEXMATCH(AE10, "Animal products"),
    REGEXMATCH(AE10, "Raw milk"),
    REGEXMATCH(AE10, "Wool, silk-worm cocoons"),
    REGEXMATCH(AE10, "Manure"),
    REGEXMATCH(AE10, "Products of meat"),
    REGEXMATCH(AE10, "Vegetable oils"),
    REGEXMATCH(AE10, "Dairy products"),
    REGEXMATCH(AE10, "Processed rice"),
    REGEXMATCH(AE10, "N-fertiliser"),
    REGEXMATCH(AE10, "P- and other fertiliser")
  ), 
  IF(AND(NOT(ISBLANK(N10)), NOT(ISBLANK(J10)), NOT(ISBLANK(X10)), NOT(ISBLANK(W10))), "YES - Agriculture", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
    REGEXMATCH(AE10, "machinery"),
    REGEXMATCH(AE10, "Capital Goods"),
    REGEXMATCH(AE10, "Machinery and equipment"),
    REGEXMATCH(AE10, "Furniture"),
    REGEXMATCH(AE10, "Office machinery")
  ), 
  IF(AND(NOT(ISBLANK(X10)), NOT(ISBLANK(N10))), "YES - Capital Goods", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
    REGEXMATCH(AE10, "Chemicals"),
    REGEXMATCH(AE10, "Plastics, basic"),
    REGEXMATCH(AE10, "Chemical and fertilizer minerals"),
    REGEXMATCH(AE10, "Rubber and plastic products"),
    REGEXMATCH(AE10, "N-fertiliser"),
    REGEXMATCH(AE10, "P- and other fertiliser")
  ),
  IF(AND(NOT(ISBLANK(J10)), OR(NOT(ISBLANK(K10)), NOT(ISBLANK(L10))), NOT(ISBLANK(N10)), NOT(ISBLANK(X10)), NOT(ISBLANK(Y10)), NOT(ISBLANK(Q10)), NOT(ISBLANK(P10)), NOT(ISBLANK(O10)), NOT(ISBLANK(V10))), "YES - Chemicals", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
    REGEXMATCH(AE10, "Coking Coal"),
    REGEXMATCH(AE10, "Other Bituminous Coal"),
    REGEXMATCH(AE10, "Sub-Bituminous Coal"),
    REGEXMATCH(AE10, "Lignite/Brown Coal"),
    REGEXMATCH(AE10, "Anthracite"),
    REGEXMATCH(AE10, "Patent Fuel"),
    REGEXMATCH(AE10, "BKB/Peat Briquettes"),
    REGEXMATCH(AE10, "Peat"),
    REGEXMATCH(AE10, "Coal Tar"),
    REGEXMATCH(AE10, "Coke Oven Coke"),
    REGEXMATCH(AE10, "Gas Coke"),
    REGEXMATCH(AE10, "Blast Furnace Gas"),
    REGEXMATCH(AE10, "Coke oven gas")
  ), IF(AND(NOT(ISBLANK(J10)), NOT(ISBLANK(N10))), "YES - Coal", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
    REGEXMATCH(AE10, "Construction work"),
    REGEXMATCH(AE10, "Bricks, tiles and construction products"),
    REGEXMATCH(AE10, "Secondary construction material")
  ), IF(AND(NOT(ISBLANK(X10)), NOT(ISBLANK(N10)), NOT(ISBLANK(Q10)), NOT(ISBLANK(J10))), "YES - Construction", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
        REGEXMATCH(AE10, "Electricity"),
    REGEXMATCH(AE10, "Electricity by coal"),
    REGEXMATCH(AE10, "Electricity by gas"),
    REGEXMATCH(AE10, "Electricity by nuclear"),
    REGEXMATCH(AE10, "Electricity by hydro"),
    REGEXMATCH(AE10, "Electricity by wind"),
    REGEXMATCH(AE10, "Electricity by petroleum"),
    REGEXMATCH(AE10, "Electricity by biomass"),
    REGEXMATCH(AE10, "Electricity by solar"),
    REGEXMATCH(AE10, "Electricity by tide"),
    REGEXMATCH(AE10, "Electricity by Geothermal"),
    REGEXMATCH(AE10, "Transmission services of electricity"),
    REGEXMATCH(AE10, "Distribution and trade services of electricity")
  ), IF(AND(NOT(ISBLANK(J10)), NOT(ISBLANK(X10)), NOT(ISBLANK(P10))), "YES - Electric Utilities", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
    REGEXMATCH(AE10, "Financial intermediation services"),
    REGEXMATCH(AE10, "Insurance and pension funding services"),
    REGEXMATCH(AE10, "Services auxiliary to financial intermediation")
  ), IF(NOT(ISBLANK(AB10)), "YES - Financial Services", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
    REGEXMATCH(AE10, "Food products"),
    REGEXMATCH(AE10, "Beverages"),
    REGEXMATCH(AE10, "Tobacco products"),
    REGEXMATCH(AE10, "Sugar"),
    REGEXMATCH(AE10, "Processed rice"),
    REGEXMATCH(AE10, "Dairy products"),
    REGEXMATCH(AE10, "Meat products"),
    REGEXMATCH(AE10, "Fish products"),
    REGEXMATCH(AE10, "Vegetable oils and fats")
  ), IF(AND(NOT(ISBLANK(N10)), NOT(ISBLANK(J10)), OR(NOT(ISBLANK(K10)), NOT(ISBLANK(L10))), NOT(ISBLANK(U10)), NOT(ISBLANK(Q10))), "YES - Food & Beverage", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
    REGEXMATCH(AE10, "Iron ores"),
    REGEXMATCH(AE10, "Copper ores"),
    REGEXMATCH(AE10, "Nickel ores"),
    REGEXMATCH(AE10, "Aluminium ores"),
    REGEXMATCH(AE10, "Precious metal ores"),
    REGEXMATCH(AE10, "Lead, zinc and tin ores"),
    REGEXMATCH(AE10, "Other non-ferrous metal ores"),
    REGEXMATCH(AE10, "Stone"),
    REGEXMATCH(AE10, "Sand and clay")
  ), IF(AND(NOT(ISBLANK(J10)), NOT(ISBLANK(W10))), "YES - Mining", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
    REGEXMATCH(AE10, "Basic iron and steel"),
    REGEXMATCH(AE10, "Precious metals"),
    REGEXMATCH(AE10, "Aluminium and aluminium products"),
    REGEXMATCH(AE10, "Lead, zinc and tin and products"),
    REGEXMATCH(AE10, "Copper products"),
    REGEXMATCH(AE10, "Other non-ferrous metal products"),
    REGEXMATCH(AE10, "Foundry work services")
  ), IF(AND(NOT(ISBLANK(J10)), NOT(ISBLANK(N10))), "YES - Metals Processing", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
    REGEXMATCH(AE10, "Crude petroleum"),
    REGEXMATCH(AE10, "Natural gas"),
    REGEXMATCH(AE10, "Natural Gas Liquids"),
    REGEXMATCH(AE10, "Other Hydrocarbons"),
    REGEXMATCH(AE10, "Motor Gasoline"),
    REGEXMATCH(AE10, "Aviation Gasoline"),
    REGEXMATCH(AE10, "Gasoline Type Jet Fuel"),
    REGEXMATCH(AE10, "Kerosene Type Jet Fuel"),
    REGEXMATCH(AE10, "Kerosene"),
    REGEXMATCH(AE10, "Gas/Diesel Oil"),
    REGEXMATCH(AE10, "Heavy Fuel Oil"),
    REGEXMATCH(AE10, "Refinery Gas"),
    REGEXMATCH(AE10, "Liquefied Petroleum Gases"),
    REGEXMATCH(AE10, "Refinery Feedstocks"),
    REGEXMATCH(AE10, "Ethane"),
    REGEXMATCH(AE10, "Naphtha")
  ), IF(AND(NOT(ISBLANK(X10)), NOT(ISBLANK(J10)), NOT(ISBLANK(N10))), "YES - Oil and Gas", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
    REGEXMATCH(AE10, "Products of forestry"),
    REGEXMATCH(AE10, "Wood and products of wood"),
    REGEXMATCH(AE10, "Wood material for treatment")
  ), IF(AND(NOT(ISBLANK(J10)), OR(NOT(ISBLANK(K10)), NOT(ISBLANK(L10))), NOT(ISBLANK(N10)), NOT(ISBLANK(W10)), NOT(ISBLANK(Y10)), NOT(ISBLANK(V10))), "YES - Forestry", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
    REGEXMATCH(AE10, "Pulp"),
    REGEXMATCH(AE10, "Paper and paper products"),
    REGEXMATCH(AE10, "Secondary paper for treatment"),
    REGEXMATCH(AE10, "Printed matter and recorded media")
  ), IF(AND(NOT(ISBLANK(N10)), NOT(ISBLANK(V10)), NOT(ISBLANK(Q10))), "YES - Paper", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
      IF(REGEXMATCH(AE10, "Real estate services"), 
    IF(AND(NOT(ISBLANK(O10)), NOT(ISBLANK(Z10)), NOT(ISBLANK(N10)), OR(NOT(ISBLANK(K10)), NOT(ISBLANK(L10)))), "YES - Real Estate", 
      IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
    REGEXMATCH(AE10, "Basic iron and steel"),
    REGEXMATCH(AE10, "Secondary steel for treatment")
  ), IF(AND(NOT(ISBLANK(J10)), OR(NOT(ISBLANK(K10)), NOT(ISBLANK(L10))), NOT(ISBLANK(N10)), NOT(ISBLANK(W10))), "YES - Steel", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
    REGEXMATCH(AE10, "Motor vehicles, trailers"),
    REGEXMATCH(AE10, "Other transport equipment")
  ), IF(AND(NOT(ISBLANK(X10)), NOT(ISBLANK(N10))), "YES - Transport Manufacturers", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(OR(
    REGEXMATCH(AE10, "Railway transportation services"),
    REGEXMATCH(AE10, "Other land transportation services"),
    REGEXMATCH(AE10, "Transportation services via pipelines"),
    REGEXMATCH(AE10, "Sea and coastal water transportation services"),
    REGEXMATCH(AE10, "Inland water transportation services"),
    REGEXMATCH(AE10, "Air transport services"),
    REGEXMATCH(AE10, "Supporting and auxiliary transport services")
  ), IF(AND(NOT(ISBLANK(J10)), NOT(ISBLANK(Q10)), NOT(ISBLANK(P10))), "YES - Transport Services", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO")),
  IF(AND(NOT(ISBLANK(N10)), NOT(ISBLANK(M10))), "YES - Other", 
    IF(AND(NOT(ISBLANK(M10)), COUNTBLANK(N10:AB10)=COLUMNS(N10:AB10)), "Not enough information", "NO"))))))))))))))))))))